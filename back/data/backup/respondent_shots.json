[
  {
    "question": "작년 총 자재 중량과 금액을 표시하세요.",
    "answer": "작년 총 자재 중량은 {{df['total_weight'].sum()}}kg이며, 총 금액은 {{df['total_amount'].sum()}} 원입니다.",
    "stats": "total_weight | total_amount\n---------------------------\n659026973.3669995 | 1814174983142.0\n"
  },
  {
  "question": "지난 달 공장별 재고 중량과 금액을 재고 금액이 큰 순으로 표시하세요.",
  "answer": "지난 달 재고 금액이 가장 큰 공장은 {{df.sort_values('total_amount', ascending=False).iloc[0]['factory_name']}}이며, 재고 중량은 {{df.sort_values('total_amount', ascending=False).iloc[0]['total_weight']}}kg, 금액은 {{df.sort_values('total_amount', ascending=False).iloc[0]['total_amount']}}원입니다. 공장별 재고 중량과 금액을 재고 금액이 큰 순으로 정렬한 표는 다음과 같습니다.",
  "stats": "factory_name | total_weight | total_amount\n------------------------------------------\n가공 | 171597257.0 | 1001920178440\n2제강 | 290347309.0 | 534161998338\n소경 | 50686286.0 | 491415317400\n2단조 | 119770167.0 | 484395495537\n소형정정 | 128900598.43500002 | 411381087073\n... (중간 생략) ...\n대형정정 | 12959030.0 | 58038454760\n1단조 | 3405308.0 | 35250258294\nRFM | 1928327.0 | 10372153615\n기타 | 90774.0 | 696943840\n | 87332.0 | 220661623\n"
  },
  {
  "question": "지난 달 공장 실 구분별 재고 중량과 금액을 재고 금액이 큰 순으로 표시하세요.",
  "answer": "지난 달 재고 금액이 가장 큰 공장 실 구분은 {{df.sort_values('total_amount', ascending=False).iloc[0]['factory_division']}}이며, 재고 중량은 {{df.sort_values('total_amount', ascending=False).iloc[0]['total_weight']}}kg, 금액은 {{df.sort_values('total_amount', ascending=False).iloc[0]['total_amount']}}원입니다. 공장 실 구분별 재고 중량과 금액을 재고 금액이 큰 순으로 정렬한 표는 다음과 같습니다.",
  "stats": "factory_division | total_weight | total_amount\n----------------------------------------------\n가공 | 171597257.0 | 1001920178440\n2제강 | 290347309.0 | 534161998338\n소경 | 50686286.0 | 491415317400\n2단조 | 119770167.0 | 484395495537\n소형정정 | 128900598.43500002 | 411381087073\n... (중간 생략) ...\n대형정정 | 12959030.0 | 58038454760\n1단조 | 3405308.0 | 35250258294\nRFM | 1928327.0 | 10372153615\n기타 | 90774.0 | 696943840\n | 87332.0 | 220661623\n"
  },
  {
  "question": "지난 달 수요가별 재고 중량과 금액을 재고 중량이 큰 순으로 표시하세요.",
  "answer": "지난 달 재고 중량이 가장 큰 수요가는 {{df.sort_values('total_weight', ascending=False).iloc[0]['customer_name']}}이며, 재고 중량은 {{df.sort_values('total_weight', ascending=False).iloc[0]['total_weight']}}kg, 금액은 {{df.sort_values('total_weight', ascending=False).iloc[0]['total_amount']}}원입니다. 수요가별 재고 중량과 금액을 재고 중량이 큰 순으로 정렬한 표는 다음과 같습니다.",
  "stats": "customer_name | total_weight | total_amount\n-------------------------------------------\n | 143027092.627 | 400681465255\n(주)세아특수강  | 42318577.0 | 72263376784\n주식회사 티플랙스  | 31155321.0 | 150054334470\n용진스테코 | 28817596.0 | 114895222122\n동일산업(주)  | 28631588.0 | 29782384276\n... (중간 생략) ...\nEUREINOX | 0.0 | 0\nKEI INDUSTRIES | 0.0 | 0\nTENGYUAN WIRE (VIETNAM) COMPANY LIMITED | 0.0 | 0\n주식회사 TNP | 0.0 | 0\nTSUKIMORI KOGYO CO., LTD. | 0.0 | 0\n"
  },
  {
  "question": "최근 3개월의 총 재고 중량과 금액을 월별로 표시하세요.",
  "answer": "최근 3개월 동안의 월별 총 재고 중량과 금액은 다음과 같습니다.",
  "stats": "year_month | total_weight | total_amount\n----------------------------------------\n2024-02 | 99583429.0 | 408749516524\n2024-03 | 103182838.0 | 407344507837\n"
  },
  {
  "question": "지난 달 총 자재 중량과 금액을 표시하세요.",
  "answer": "지난 달 총 자재 중량은 {{df['total_weight'].sum()}}kg이며, 총 금액은 {{df['total_amount'].sum()}}원입니다.",
  "stats": "total_weight | total_amount\n---------------------------\n659026973.3669995 | 1814174983142.0\n"
  },
  {
    "question": "지난 달 평가클래스별 자재 중량과 금액을 원료 금액이 큰 순으로 표시하세요.",
    "answer": "지난 달 원료 금액이 가장 큰 평가클래스는 {{df.sort_values('total_amount', ascending=False).iloc[0]['eval_class_name']}}이며, 중량은 {{df.sort_values('total_amount', ascending=False).iloc[0]['total_weight']:,.0f}}kg, 금액은 {{df.sort_values('total_amount', ascending=False).iloc[0]['total_amount']:,.0f}}원입니다. 평가클래스별 자재 중량과 금액을 금액 기준으로 정렬한 표는 다음과 같습니다.",
    "stats": "eval_class_name | total_weight | total_amount\n---------------------------------------------\n원재료 1(SeAH) | 375651563.3669995 | 1122463398424.0\n부재료(SeAH) | 249959103.0 | 428362283931.0\n | 33416307.0 | 263349300787.0\n"
  },
  {
  "question": "지난 달 자재 유형별 자재 중량과 금액을 원료 중량이 큰 순으로 표시하세요.",
  "answer": "지난 달 자재 중량이 가장 큰 자재 유형은 {{df.sort_values('total_weight', ascending=False).iloc[0]['material_type_name']}}이며, 중량은 {{df.sort_values('total_weight', ascending=False).iloc[0]['total_weight']}}kg, 금액은 {{df.sort_values('total_weight', ascending=False).iloc[0]['total_amount']}}원입니다. 자재 유형별 자재 중량과 금액을 중량 기준으로 정렬한 표는 다음과 같습니다.",
  "stats": "material_type_name | total_weight | total_amount\n------------------------------------------------\n | 375651563.3669995 | 1122463398424.0\n[세아] 원재료 | 247045384.0 | 422715617043.0\n[세아] 부재료 | 33416307.0 | 263349300787.0\n[세아] 구입소재 | 2913719.0 | 5646666888.0\n"
  },
  {
  "question": "최근 3개월의 총 자재 중량과 금액을 월별로 표시하세요.",
  "answer": "최근 3개월 동안의 월별 총 자재 중량과 금액은 다음과 같습니다.",
  "stats": "year_month | total_weight | total_amount\n----------------------------------------\n2024-02 | 65638318.84100007 | 201341415877.0\n2024-03 | 61217054.21000006 | 188352026731.0\n"
  },
  {
  "question": "최근 3개월 평가클래스별 자재 중량과 금액을 월별로 표시하세요.",
  "answer": "최근 3개월 동안의 평가클래스별 월별 자재 중량과 금액은 다음과 같습니다.",
  "stats": "year_month | eval_class_name | total_weight | total_amount\n----------------------------------------------------------\n2024-02 |  | 65638318.84100007 | 201341415877.0\n2024-03 |  | 61217054.21000006 | 188352026731.0\n2024-04 |  | 65363886.426000014 | 186278984252.0\n"
  },
  {
    "question": "최근 3개월 공장별 재고 중량과 금액을 월별로 표시하세요.",
    "answer": "최근 3개월 동안 공장별 재고 중량과 금액은 {{df['year_month'].min()}}부터 {{df['year_month'].max()}}까지의 기간 동안 집계되었으며, 중량이 가장 많은 공장은 {{df.groupby('factory_name')['total_weight'].sum().sort_values(ascending=False).index[0]}}로 총 {{df.groupby('factory_name')['total_weight'].sum().sort_values(ascending=False).iloc[0]}}kg입니다. 월별 상세 내역은 아래 표를 참고하세요.",
    "stats": "year_month | factory_name | total_weight | total_amount\n-------------------------------------------------------\n2024-02 |  | 26870.0 | 67574386\n2024-02 | 1단조 | 232655.0 | 2590577427\n2024-02 | 2단조 | 11675831.0 | 44128037717\n2024-02 | 2제강 | 23518144.0 | 46771418125\n2024-02 | 3제강 | 6318092.0 | 26506352357\n... (중간 생략) ...\n2024-04 | 산세 | 6760150.0 | 28043242795\n2024-04 | 소경 | 4466675.0 | 41576301632\n2024-04 | 소형압연 | 9455913.0 | 15805695571\n2024-04 | 소형정정 | 13124080.0 | 41113900794\n2024-04 | 특수제강 | 855272.0 | 19695996551\n"
  },
  {
    "question": "최근 3개월 공장의 실별 재고 중량과 금액을 월별로 표시하세요.",
    "answer": "최근 3개월 동안 공장의 실별 재고 중량과 금액은 {{df['year_month'].min()}}부터 {{df['year_month'].max()}}까지의 기간 동안 분석되었으며, 중량이 가장 많은 실 구분은 {{df.groupby('factory_department')['total_weight'].sum().sort_values(ascending=False).index[0]}}로 총 {{df.groupby('factory_department')['total_weight'].sum().sort_values(ascending=False).iloc[0]}}kg입니다. 자세한 내역은 아래 표를 확인하세요.",
    "stats": "year_month | factory_department | total_weight | total_amount\n-------------------------------------------------------------\n2025-02 | 1단조 | 215782.0 | 2315306053\n2025-02 | 2단조 | 8181325.0 | 34427889409\n2025-02 | 2제강 | 16608189.0 | 30841845718\n2025-02 | 3제강 | 3269375.0 | 13520556785\n2025-02 | RFM | 248602.0 | 998981992\n... (중간 생략) ...\n2025-02 | 산세 | 5080094.0 | 22740813390\n2025-02 | 소경 | 3322003.0 | 33373107753\n2025-02 | 소형압연 | 10004101.0 | 22235925862\n2025-02 | 소형정정 | 10086822.521 | 31431970665\n2025-02 | 특수제강 | 870415.0 | 13977555549\n"
  },
  {
    "question": "최근 3개월 제소구분별 재고 중량과 금액을 월별로 표시하세요.",
    "answer": "최근 3개월 동안 제소구분별 재고 현황을 보면, {{df['year_month'].min()}}부터 {{df['year_month'].max()}}까지의 기간 동안 중량이 가장 많은 제소구분은 {{df.groupby('item_category')['total_weight'].sum().sort_values(ascending=False).index[0]}}이며 총 {{df.groupby('item_category')['total_weight'].sum().sort_values(ascending=False).iloc[0]}}kg입니다.",
    "stats": "year_month | item_category | total_weight | total_amount\n--------------------------------------------------------\n2024-02 | 소재 | 35041222.0 | 135141215559\n2024-02 | 제품 | 64542207.0 | 273608300965\n2024-03 | 소재 | 37274127.0 | 136341094249\n2024-03 | 제품 | 65908711.0 | 271003413588\n"
  },
  {
    "question": "최근 3개월 주여구분별 재고 중량과 금액을 월별로 표시하세요.",
    "answer": "최근 3개월 동안 주여구분별 재고는 {{df['year_month'].min()}}부터 {{df['year_month'].max()}}까지 월별로 집계되었으며, 중량 기준으로 가장 많은 주여구분은 {{df.groupby('order_type')['total_weight'].sum().sort_values(ascending=False).index[0]}}로 총 {{df.groupby('order_type')['total_weight'].sum().sort_values(ascending=False).iloc[0]}}kg입니다.",
    "stats": "year_month | order_type | total_weight | total_amount\n-----------------------------------------------------\n2024-02 |  | 0.0 | 0\n2024-02 | 여재 | 31334555.0 | 106174867305\n2024-02 | 주문재 | 68248874.0 | 302574649219\n2024-03 |  | 0.0 | 0\n2024-03 | 여재 | 33279045.0 | 108528079326\n2024-03 | 주문재 | 69903793.0 | 298816428511\n"
  },
  {
    "question": "최근 3개월 제소구분별, 대강종별 재고 중량과 금액을 월별로 표시하세요.",
    "answer": "최근 3개월 동안 제소구분과 대강종별로 구분된 재고 중량 및 금액은 {{df['year_month'].min()}}부터 {{df['year_month'].max()}}까지의 기간 동안 기록되었으며, 가장 중량이 큰 조합은 {{df.groupby(['item_category','major_steel_type'])['total_weight'].sum().sort_values(ascending=False).index[0]}}로 총 {{df.groupby(['item_category','major_steel_type'])['total_weight'].sum().sort_values(ascending=False).iloc[0]}}kg입니다.",
    "stats": "year_month | item_category | major_steel_type | total_weight | total_amount\n---------------------------------------------------------------------------\n2024-01 | 소재 | STS | 22129141.0 | 76356496896\n2024-01 | 소재 | 공구강 | 1982700.0 | 5406661870\n2024-01 | 소재 | 탄합강 | 5653531.0 | 7200371947\n2024-01 | 소재 | 특수합금 | 1642130.0 | 44013204288\n2024-01 | 제품 | STS | 28164689.0 | 157829239524\n... (중간 생략) ...\n2024-12 | 소재 | 특수합금 | 924860.0 | 24849243275\n2024-12 | 제품 | STS | 25755373.0 | 138092299691\n2024-12 | 제품 | 공구강 | 12621279.0 | 50140935122\n2024-12 | 제품 | 탄합강 | 18316326.965 | 32250500904\n2024-12 | 제품 | 특수합금 | 931866.0 | 32935707815\n"
  },
  {
  "question": "24년 2월 기준으로 SAP 대분류별 자재 중량을 중량이 큰 순으로 나열하세요.",
  "answer": "2024년 2월 기준 SAP 대분류별 자재 중량은 {{df.sort_values('total_weight', ascending=False).iloc[0]['sap_category_l1']}}이 가장 많으며, 중량은 {{df.sort_values('total_weight', ascending=False).iloc[0]['total_weight']}}kg입니다. 전체 대분류별 중량은 중량이 큰 순으로 정렬된 표를 참고하세요.",
  "stats": "sap_category_l1 | total_weight\n------------------------------\n스크랩 | 565968315.0\n합금철 | 69523090.0\n제강보조재 | 9135861.02\n구입소재 | 6719414.0\n유류/가스 | 2749854.0\n... (중간 생략) ...\n토건자재 | 3497.0\n포장재 | 2400.0\n | 0.0\n외주 | -7.623000000000005\n수리 | -37.60000000000001\n"
  },
  {
    "question": "자재에 대해 SAP 대분류 별로 구분하여 3개월치에 대한 추이를 보여주세요.",
    "answer": "최근 3개월 동안 SAP 대분류별 자재 중량과 금액 추이는 {{df['year_month'].min()}}부터 {{df['year_month'].max()}}까지의 기간 동안 {{df['sap_category_l1'].nunique()}}개의 대분류에서 변화 양상을 보여주고 있으며, 상세 내용은 아래 표를 참고하세요.",
    "stats": "year_month | sap_category_l1 | total_weight | total_amount\n----------------------------------------------------------\n2024-10 | 구입소재 | 385949.0 | 765634823.0\n2024-10 | 스크랩 | 41873075.0 | 68739581136.0\n2024-10 | 합금철 | 5539406.0 | 42547920503.0\n2024-11 | 구입소재 | 418763.0 | 810240023.0\n2024-11 | 스크랩 | 40550646.0 | 69745624948.0\n2024-11 | 합금철 | 6070265.0 | 42985842388.0\n"
  },
  {
    "question": "24년 2월 기준으로 구입스크랩, 자가철스크랩, 합금철, 구입소재로 분류하여 중량이 큰 순으로 중량을 표시하세요.",
    "answer": "2024년 2월 기준 자재를 분류한 결과, 중량이 가장 큰 분류는 {{df.sort_values('total_weight', ascending=False).iloc[0]['main_category']}}이며, 해당 중량은 {{df.sort_values('total_weight', ascending=False).iloc[0]['total_weight']}}kg입니다. 전체 분류별 중량은 중량이 큰 순으로 정렬한 표를 참고하세요.",
    "stats": "main_category | total_weight\n----------------------------\n구입스크랩 | 420931996.0\n자가철스크랩 | 145036319.0\n합금철 | 69523090.0\n기타 | 20621849.367000125\n구입소재 | 2913719.0\n"
  },
  {
    "question": "자재에 대해 구입스크랩, 자가철스크랩, 합금철, 구입소재로 구분하여 3개월치에 대한 추이를 보여주세요.",
    "answer": "최근 3개월 동안 자재는 구입스크랩, 자가철스크랩, 합금철, 구입소재의 4가지 주요 분류로 나뉘며, 그 추이는 아래 표에서 확인할 수 있습니다.",
    "stats": "year_month | main_category | total_weight | total_amount\n--------------------------------------------------------\n2024-01 | 구입스크랩 | 41532671.0 | 57220982956.0\n2024-01 | 기타 | 3365947.624999994 | 30974504229.0\n2024-01 | 자가철스크랩 | 15766565.0 | 46137164028.0\n2024-01 | 합금철 | 6156560.0 | 64398270471.0\n2024-02 | 구입스크랩 | 40483319.0 | 56896239172.0\n... (중간 생략) ...\n2024-02 | 합금철 | 5889115.0 | 67804736836.0\n2024-03 | 구입스크랩 | 37637832.0 | 48441885749.0\n2024-03 | 기타 | 3267053.20999999 | 30389296122.0\n2024-03 | 자가철스크랩 | 14697592.0 | 44351564577.0\n2024-03 | 합금철 | 5614577.0 | 65169280283.0\n"
  },
  {
    "question": "구입 스크랩에 대해 STS스크랩, 일반스크랩, 특수합금강으로 구분하여 3개월의 추이를 보여주세요.",
    "answer": "최근 3개월 동안 구입 스크랩은 STS스크랩, 일반스크랩, 특수합금강으로 구분되며, 이들 분류의 중량 및 금액 추이는 아래 표에 나타나 있습니다.",
    "stats": "year_month | sub_category | total_weight | total_amount\n-------------------------------------------------------\n2024-02 | STS스크랩 | 20380347.0 | 41944050729.0\n2024-02 | 일반스크랩 | 19943287.0 | 11749043088.0\n2024-02 | 특수합금강 | 159685.0 | 3203145355.0\n2024-03 | STS스크랩 | 16631261.0 | 32605059327.0\n2024-03 | 일반스크랩 | 20809837.0 | 12448901189.0\n2024-03 | 특수합금강 | 196734.0 | 3387925233.0\n"
  }
]
