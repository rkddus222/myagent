[
  {
    "question": "지난 달 총 자재 중량과 금액을 표시하세요.",
    "answer": "지난 달 총 자재 중량은 {df['total_weight'].sum()}kg이며, 총 금액은 {df['total_amount'].sum()}원입니다.",
    "stats": "total_weight | total_amount\n---------------------------\n |40832675.0 | 99404999072.0 \n"
  },
  {
    "question": "지난 달 평가클래스별 자재 중량과 금액을 원료 금액이 큰 순으로 표시하세요.",
    "answer": "지난 달 평가 클래스 중에서 {df.sort_values('total_amount', ascending=False).iloc[0]['eval_class_name']} 클래스의 원료 중량이 가장 많았으며, 총 중량은 {df.sort_values('total_amount', ascending=False).iloc[0]['total_weight']}kg이었습니다. 또한, 이 클래스의 원료 총 금액은 {df.sort_values('total_amount', ascending=False).iloc[0]['total_amount']}원으로 가장 높았습니다. 평가 클래스별 원료 중량과 금액을 원료 금액이 큰 순으로 정렬한 표는 다음과 같습니다.",
    "stats": "year_month | total_weight | total_amount\n----------------------------------------\n2025-02 | 40832675.0 | 99404999072.0\n"
  },
  {
    "question": "지난 달 자재 유형별 자재 중량과 금액을 원료 중량이 큰 순으로 표시하세요.",
    "answer": "지난 달 자재 유형별로 가장 많은 중량을 차지한 자재는 {df.sort_values('total_weight', ascending=False).iloc[0]['material_type_name']}이며, 해당 자재의 총 중량은 {df.sort_values('total_weight', ascending=False).iloc[0]['total_weight']}kg, 총 금액은 {df.sort_values('total_weight', ascending=False).iloc[0]['total_amount']}원입니다. 자재 유형별 총 중량과 금액을 중량이 큰 순으로 정렬한 표는 다음과 같습니다.",
    "stats": "sap_category_l1 | total_weight\n------------------------------\n스크랩 | 36704680.0\n합금철 | 4647310.0\n구입소재 | 397336.0\n"
  },
  {
    "question": "최근 3개월의 총 자재 중량과 금액을 월별로 표시하세요.",
    "answer": "최근 3개월 동안의 월별 총 자재 중량과 금액은 다음과 같습니다: {df['year_month'].values}에 해당하는 총 자재 중량은 각각 {df['total_weight'].values}kg이며, 총 금액은 각각 {df['total_amount'].values}원입니다.",
    "stats": "year_month | sap_category_l1 | total_weight | total_amount\n----------------------------------------------------------\n2024-12 | 구입소재 | 620669.0 | 982374863.0\n2024-12 | 스크랩 | 36519851.0 | 67758170767.0\n2024-12 | 합금철 | 5250662.0 | 35079452634.0\n2025-01 | 구입소재 | 458881.0 | 868679063.0\n2025-01 | 스크랩 | 32059143.0 | 65564900879.0\n2025-01 | 합금철 | 5159868.0 | 35605277955.0\n2025-02 |  | 0.0 | 0.0\n2025-02 | 구입소재 | 841615.0 | 1342212604.0\n2025-02 | 스크랩 | 34883472.0 | 63244996038.0\n2025-02 | 합금철 | 5107588.0 | 34817790430.0\n"
  },
  {
    "question": "최근 3개월 평가클래스별 자재 중량과 금액을 월별로 표시하세요.",
    "answer": "최근 3개월 동안 평가 클래스별로 월별 자재 중량과 금액이 집계되었습니다. 각 평가 클래스의 총 중량은 {df.groupby('eval_class_name')['total_weight'].sum()}kg이며, 총 금액은 {df.groupby('eval_class_name')['total_amount'].sum()}원입니다. 월별로 분류된 자세한 정보는 다음 테이블을 참조하세요.",
    "stats": "main_category | total_weight\n----------------------------\n구입스크랩 | 28168787.0\n자가철스크랩 | 8535893.0\n합금철 | 4647310.0\n구입소재 | 397336.0\n"
  },
  {
    "question": "24년 9월 기준으로 SAP 대분류별 자재 중량을 중량이 큰 순으로 나열하세요.",
    "answer": "2024년 9월 기준으로 SAP 대분류별 자재 중량이 가장 큰 항목은 {df.sort_values('total_weight', ascending=False).iloc[0]['sap_category_l1']}이며, 그 중량은 {df.sort_values('total_weight', ascending=False).iloc[0]['total_weight']}kg입니다. SAP 대분류별 자재 중량을 중량이 큰 순으로 정렬한 표는 다음과 같습니다.",
    "stats": "year_month | category | total_weight | total_amount\n---------------------------------------------------\n2024-12 | 구입스크랩 | 27041090.0 | 31855527131.0\n2024-12 | 기타 | 620669.0 | 982374863.0\n2024-12 | 자가철스크랩 | 9478761.0 | 35902643636.0\n2024-12 | 합금철 | 5250662.0 | 35079452634.0\n2025-01 | 구입스크랩 | 22589342.0 | 29210304560.0\n... (중간 생략) ...\n2025-01 | 합금철 | 5159868.0 | 35605277955.0\n2025-02 | 구입스크랩 | 25340802.0 | 27387514296.0\n2025-02 | 기타 | 841615.0 | 1342212604.0\n2025-02 | 자가철스크랩 | 9542670.0 | 35857481742.0\n2025-02 | 합금철 | 5107588.0 | 34817790430.0\n"
  },
  {
    "question": "자재에 대해 SAP 대분류 별로 구분하여 3개월치에 대한 추이를 보여주세요.",
    "answer": "지난 3개월 동안 SAP 대분류 별로 구분한 자재의 총 중량은 {df['total_weight'].sum()}kg이며, 총 금액은 {df['total_amount'].sum()}원입니다. 각 대분류 별 자재 중량과 금액의 추이는 테이블로 확인하실 수 있습니다.",
    "stats": "year_month | category | total_weight | total_amount\n---------------------------------------------------\n2024-12 | STS스크랩 | 10486053.0 | 19447631699.0\n2024-12 | 특수합금강 | 319316.0 | 3799997681.0\n2025-01 | STS스크랩 | 9365440.0 | 17882934840.0\n2025-01 | 특수합금강 | 319316.0 | 3799997681.0\n2025-02 | STS스크랩 | 8614515.0 | 14348711951.0\n2025-02 | 특수합금강 | 311406.0 | 3738900380.0\n"
  },
  {
    "question": "24년 9월 기준으로 구입스크랩, 자가철스크랩, 합금철, 구입소재로 분류하여 중량이 큰 순으로 중량을 표시하세요.",
    "answer": "2024년 9월 기준으로 구입스크랩, 자가철스크랩, 합금철, 구입소재로 분류하여 중량이 가장 큰 항목은 {df.sort_values('total_weight', ascending=False).iloc[0]['main_category']}이며, 그 중량은 {df.sort_values('total_weight', ascending=False).iloc[0]['total_weight']}kg입니다. 각 카테고리별 중량을 큰 순으로 정렬한 표는 다음과 같습니다.",
    "stats": "year_month | category | total_weight | total_amount\n---------------------------------------------------\n2024-12 | STS | 5055941.0 | 9712005050.0\n2024-12 | 공구강 | 760010.0 | 950296155.0\n2024-12 | 탄합강 | 2089419.0 | 1042348241.0\n2024-12 | 특수합금강 | 1573391.0 | 24197994190.0\n2025-01 | STS | 5344226.0 | 10623336162.0\n... (중간 생략) ...\n2025-01 | 특수합금강 | 1553792.0 | 24021132073.0\n2025-02 | STS | 5481954.0 | 10467866833.0\n2025-02 | 공구강 | 466626.0 | 588699011.0\n2025-02 | 탄합강 | 2083331.0 | 1032010974.0\n2025-02 | 특수합금강 | 1510759.0 | 23768904924.0\n"
  },
  {
    "question": "자재에 대해 구입스크랩, 자가철스크랩, 합금철, 구입소재로 구분하여 3개월치에 대한 추이를 보여주세요.",
    "answer": "지난 3개월 동안 구입스크랩, 자가철스크랩, 합금철, 구입소재별로 총 중량은 각각 {df[df['main_category']=='구입스크랩']['total_weight'].sum()}kg, {df[df['main_category']=='자가철스크랩']['total_weight'].sum()}kg, {df[df['main_category']=='합금철']['total_weight'].sum()}kg, {df[df['main_category']=='구입소재']['total_weight'].sum()}kg이며, 총 금액은 각각 {df[df['main_category']=='구입스크랩']['total_amount'].sum()}원, {df[df['main_category']=='자가철스크랩']['total_amount'].sum()}원, {df[df['main_category']=='합금철']['total_amount'].sum()}원, {df[df['main_category']=='구입소재']['total_amount'].sum()}원입니다.",
    "stats": "year_month | category | total_weight | total_amount\n---------------------------------------------------\n2024-12 | 일반합금철 | 5074855.0 | 28800572510.0\n2024-12 | 특수합금강 | 175807.0 | 6278880124.0\n2025-01 | 일반합금철 | 4987976.0 | 29385525895.0\n2025-01 | 특수합금강 | 171892.0 | 6219752060.0\n2025-02 | 일반합금철 | 4934542.0 | 28360376553.0\n2025-02 | 특수합금강 | 173046.0 | 6457413877.0\n"
  },
  {
    "question": "구입 스크랩에 대해 STS스크랩, 일반스크랩, 특수합금강으로 구분하여 3개월의 추이를 보여주세요.",
    "answer": "구입 스크랩의 STS스크랩, 일반스크랩, 특수합금강의 최근 3개월 동안의 총 중량은 각각 {df[df['sub_category']=='STS스크랩']['total_weight'].sum()}kg, {df[df['sub_category']=='일반스크랩']['total_weight'].sum()}kg, {df[df['sub_category']=='특수합금강']['total_weight'].sum()}kg이며, 총 금액은 각각 {df[df['sub_category']=='STS스크랩']['total_amount'].sum()}원, {df[df['sub_category']=='일반스크랩']['total_amount'].sum()}원, {df[df['sub_category']=='특수합금강']['total_amount'].sum()}원입니다.",
    "stats": "year_month | total_weight | total_amount\n----------------------------------------\n2024-01 | 57299236.0 | 103358146984.0\n2024-02 | 56066886.0 | 102593267574.0\n2024-03 | 52335424.0 | 92793450326.0\n2024-04 | 56070470.0 | 92299469472.0\n2024-05 | 50425389.0 | 87808184180.0\n... (중간 생략) ...\n2024-10 | 41873075.0 | 68739581136.0\n2024-11 | 40550646.0 | 69745624948.0\n2024-12 | 36519851.0 | 67758170767.0\n2025-01 | 32059143.0 | 65564900879.0\n2025-02 | 34883472.0 | 63244996038.0\n"
  },
  {
    "question": "자가철 스크랩에 대해 STS, 탄합강, 공구강, 특수합금강으로 구분하여 3개월의 추이를 보여주세요.",
    "answer": "최근 3개월간 자가철 스크랩의 카테고리별 중량과 금액은 다음과 같습니다. STS의 총 중량은 {df[df['category']=='STS']['total_weight'].sum()}kg이며, 총 금액은 {df[df['category']=='STS']['total_amount'].sum()}원입니다. 탄합강의 총 중량은 {df[df['category']=='탄합강']['total_weight'].sum()}kg이며, 총 금액은 {df[df['category']=='탄합강']['total_amount'].sum()}원입니다. 공구강의 총 중량은 {df[df['category']=='공구강']['total_weight'].sum()}kg이며, 총 금액은 {df[df['category']=='공구강']['total_amount'].sum()}원입니다. 특수합금강의 총 중량은 {df[df['category']=='특수합금강']['total_weight'].sum()}kg이며, 총 금액은 {df[df['category']=='특수합금강']['total_amount'].sum()}원입니다.",
    "stats": "year | quarter | total_weight | total_amount\n--------------------------------------------\n2024 | Q1 | 2841397.0 | 87634166055.0\n2024 | Q2 | 2862203.0 | 88307518095.0\n2024 | Q3 | 2389994.0 | 73840586992.0\n2024 | Q4 | 1697464.0 | 54996275236.0\n"
  },
  {
    "question": "합금철에 대해 일반합금철, 특수합금강으로 구분하여 3개월의 추이를 보여주세요.",
    "answer": "지난 3개월 동안 합금철 중 일반합금철의 총 중량은 {df[df['category'] == '일반합금철']['total_weight'].sum()}kg이며, 총 금액은 {df[df['category'] == '일반합금철']['total_amount'].sum()}원입니다. 특수합금강의 총 중량은 {df[df['category'] == '특수합금강']['total_weight'].sum()}kg이며, 총 금액은 {df[df['category'] == '특수합금강']['total_amount'].sum()}원입니다. 이를 통해 합금철의 월별 추이를 확인할 수 있습니다.",
    "stats": "total_weight | total_amount\n---------------------------\n |40832675.0 | 99404999072.0 \n"
  },
  {
    "question": "구입소재에 대해 3개월의 추이를 보여주세요.",
    "answer": "최근 3개월 동안 '[세아] 구입소재'의 총 중량은 {df['total_weight'].sum()}kg이며, 총 금액은 {df['total_amount'].sum()}원입니다. 월별 구입소재 중량과 금액의 변동 추이는 다음과 같습니다.",
    "stats": "sap_category_l2 | weight_ratio\n------------------------------\n구입탄합강스크랩 | 42.72\n구입STS강스크랩 | 24.7\n사내STS강스크랩 | 15.72\n사내탄합강스크랩 | 5.97\n구입공구금형강스크랩 | 4.34\n사내특수합금강스크랩 | 4.33\n사내공구금형강스크랩 | 1.34\n구입특수합금강스크랩 | 0.89\n"
  },
  {
    "question": "스크랩 자재에 대한 월별 추이를 보여주세요.",
    "answer": "스크랩 자재의 월별 총 중량은 {df['total_weight'].sum()}kg이며, 총 금액은 {df['total_amount'].sum()}원입니다. 월별 자세한 데이터는 다음과 같습니다.",
    "stats": "year_month | material_detail | total_weight_ton | total_amount_million\n----------------------------------------------------------------------\n2024-01 | 316.자가발생철 | 3005.47 | 10154.12\n2024-01 | STS316 BRIQUET 구입 | 299.75 | 967.61\n2024-01 | STS316 구입 | 3111.55 | 11145.06\n2024-01 | 자가발생철 EP316LVV 강괴 | 258.55 | 2798.72\n2024-02 | 316.자가발생철 | 3163.41 | 10657.58\n... (중간 생략) ...\n2025-02 | DUPLEX 자가발생철_사내 DUPLEX | 1122.38 | 3154.74\n2025-02 | STS316 BRIQUET 구입_S316BQ | 29.07 | 92.9\n2025-02 | STS316 구입_S316_S316BD | 18.33 | 62.97\n2025-02 | 자가발생철 EP316LVV 강괴_사내 S316LVV 강괴 | 188.09 | 2044.36\n2025-02 | 자가발생철 EP316_사내 EP316 | 7.43 | 44.04\n"
  },
  {
    "question": "합금철 중 특수합금에 대한 24년 분기별 추이를 보여주세요.",
    "answer": "2024년에 합금철 중 특수합금의 분기별 총 중량은 {df.groupby('분기')['total_weight'].sum()}kg이며, 총 금액은 {df.groupby('분기')['total_amount'].sum()}원입니다. 분기별 총 중량과 금액을 분기별로 정렬한 표는 다음과 같습니다.",
    "stats": "year_month | total_weight | total_amount\n----------------------------------------\n2025-02 | 398033.0 | 14328015183.0\n"
  },
  {
    "question": "자재 중 우주항공용 자재에 대한 24년 5월 중량, 금액을 알려주세요.",
    "answer": "2024년 5월에 우주항공용 자재의 총 중량은 {df['total_weight'].sum()}kg이며, 총 금액은 {df['total_amount'].sum()}원입니다.",
    "stats": "sap_category_l2 | sap_category_l3 | total_weight | total_amount\n---------------------------------------------------------------\nAL | AL METAL | 115954.0 | 372917289.0\nAL | AL탈산제 | 99026.0 | 158954939.0\nB | FE-B | 10000.0 | 46053596.0\nCR | (H)FE-CR | 2030797.0 | 4525639949.0\nCR | (L)FE-CR | 123000.0 | 566726760.0\n... (중간 생략) ...\n특수합금철 | NI-NB | 0.0 | 0.0\n특수합금철 | NI-TA | 3654.0 | 1217015468.0\n특수합금철 | NI-ZR | 495.0 | 29915436.0\n특수합금철 | TI SPONGE | 19718.0 | 281472820.0\n특수합금철 | 전기동 | 26793.0 | 331051942.0\n"
  },
  {
    "question": "스크랩 중에서 구입 스크랩과 자가철 스크랩을 구분하여 전전월과 전월의 중량과 금액을 조회하세요. 월을 컬럼으로 배치하고 전월 대비 당월의 증감을 계산해 표시해 주세요.",
    "answer": "스크랩 카테고리별로 전전월과 전월의 중량과 금액을 조회한 결과, 구입 스크랩의 전월 중량은 {df[df['category']=='구입스크랩']['total_weight_prev_month'].values[0]}kg, 금액은 {df[df['category']=='구입스크랩']['total_amount_prev_month'].values[0]}원이며, 전전월 대비 중량은 {df[df['category']=='구입스크랩']['weight_diff_mom'].values[0]}kg, 금액은 {df[df['category']=='구입스크랩']['amount_diff_mom'].values[0]}원 증가하였습니다. 자가철 스크랩의 전월 중량은 {df[df['category']=='자가철스크랩']['total_weight_prev_month'].values[0]}kg, 금액은 {df[df['category']=='자가철스크랩']['total_amount_prev_month'].values[0]}원이며, 전전월 대비 중량은 {df[df['category']=='자가철스크랩']['weight_diff_mom'].values[0]}kg, 금액은 {df[df['category']=='자가철스크랩']['amount_diff_mom'].values[0]}원 증가하였습니다.",
    "stats": "year_month | total_weight | total_amount\n----------------------------------------\n2024-01 | 1182580.0 | 5826801043.0\n2024-02 | 1062580.0 | 5220091441.0\n2024-03 | 904580.0 | 4421257131.0\n2024-04 | 816580.0 | 3976336755.0\n2024-05 | 439580.0 | 2070257422.0\n2024-06 | 299580.0 | 1362429553.0\n"
  },
  {
    "question": "스크랩을 구입 스크랩과 자가철 스크랩으로 분류를 한 후 자재내역별로 24년 7월, 8월의 중량과 금액을 조회하세요. 월을 컬럼으로 표시하고 8월 기준으로 전월비를 계산해 표시하세요. 전월비 감소폭이 큰 순으로 자재내역을 나열해주세요.",
    "answer": "스크랩을 구입 스크랩과 자가철 스크랩으로 분류한 후, 2024년 7월과 8월의 각 자재별 중량과 금액을 조회하였습니다. 8월 기준으로 전월 대비 중량과 금액의 변동을 계산하여, 감소폭이 큰 순으로 자재를 나열하였습니다. 자세한 내용은 조회된 테이블을 참조해주세요.",
    "stats": "category | material_detail | total_weight_2024 | total_amount_2024\n------------------------------------------------------------------\n구입스크랩 | 생철 경량류 | 43456702.0 | 22007048545.0\n구입스크랩 | STS304 구입 | 40241229.0 | 75756266087.0\n구입스크랩 | 생철 중량류_생철A_생철L_생철O | 37837885.0 | 18252069213.0\n구입스크랩 | 생철 중량류 | 36558678.0 | 19018520994.0\n구입스크랩 | 중량류_중량A_중량AL_중량B_중량BL_중량O_중량ABL(Z) | 34340531.0 | 16126004469.0\n... (중간 생략) ...\n구입스크랩 | NIMONIC80A_NIMONIC80AG | 0.0 | 0.0\n자가철스크랩 | PERMALLOY.자가발생철_사내 PERMALLOY | 0.0 | 0.0\n자가철스크랩 | 자가발생철 ALLOY7001S2_사내 ALLOY7001S2 | 0.0 | 0.0\n자가철스크랩 | ALLOY20 자가발생철_사내 ALLOY20 | 0.0 | 0.0\n자가철스크랩 | ALLOY495 자가발생철_사내 ALLOY495 | 0.0 | 0.0"
  },
  {
    "question": "가장 최근의 스크랩의 자재량을 SAP 중분류별로 구분하여 비율로 알려주세요.",
    "answer": "가장 최근에 기록된 스크랩의 자재량은 SAP 중분류별로 다음과 같이 구분되며, 각각의 비율은 다음과 같습니다.",
    "stats": "sap_category_l1 | sap_category_l2 | total_weight\n------------------------------------------------\n구입소재 | 세아내탄합강압연품 | 44672.0\n구입소재 | 세아내탄합강제강품 | 11740.0\n구입소재 | 세아외탄합강압연품 | 277931.0\n구입소재 | 세아외탄합강제강품 | 276797.0\n구입소재 | 세아외특수합금강제강품 | 8418.0\n... (중간 생략) ...\n합금철 | V | 21559.0\n합금철 | W | 14417.0\n합금철 | WIRE | 129642.0\n합금철 | 우주항공용 | 661797.0\n합금철 | 특수합금철 | 214185.0\n"
  },
  {
    "question": "S316계의 월별 자재 추이를 자재내역별 표시해주세요. 중량과 금액 모두 표시가 필요하며 단위는 톤, 백만원으로 해주세요.",
    "answer": "S316계의 월별 자재 추이는 다음과 같습니다. 각 자재별 총 중량은 {df['total_weight_ton'].sum()}톤이며, 총 금액은 {df['total_amount_million'].sum()} 백만원입니다. 자세한 자재내역별 중량과 금액은 테이블을 참조해주세요.",
    "stats": "year_month | total_weight | total_amount\n----------------------------------------\n2024-01 | 66821743.62500007 | 198730921684.0\n2024-02 | 65638318.84100007 | 201341415877.0\n2024-03 | 61217054.21000006 | 188352026731.0\n2024-04 | 65363886.426000014 | 186278984252.0\n2024-05 | 60234815.856000006 | 178372542365.0\n... (중간 생략) ...\n2024-08 | 56863165.0 | 127366445725.0\n2024-09 | 41749326.0 | 102705836026.0\n2024-10 | 47798430.0 | 112053136462.0\n2024-11 | 47039674.0 | 113541707359.0\n2024-12 | 42391182.0 | 103819998264.0\n"
  },
  {
    "question": "400스크랩의 월별 자재 추이를 자재내역별 표시해주세요. 중량과 금액 모두 표시가 필요하며 단위는 톤, 백만원으로 해주세요.",
    "answer": "400스크랩의 월별 자재 추이는 {df.groupby('year_month')['material_detail'].count()}건이며, 총 중량은 {df['total_weight_ton'].sum()}톤, 총 금액은 {df['total_amount_million'].sum()}백만원입니다. 자재내역별로 보면, {df.groupby('material_detail')['total_weight_ton'].sum()}톤, {df.groupby('material_detail')['total_amount_million'].sum()}백만원입니다.",
    "stats": "material_code | total_weight_ton | total_amount_million\n-------------------------------------------------------\nBF000076 | 375.89 | 551.39\nBF000077 | 797.15 | 1954.73\nBF000078 | 659.55 | 1170.72\nBF000079 | 459.18 | 867.18\nBF000080 | 445.01 | 1055.91\n... (중간 생략) ...\nBF000145 | 4.18 | 219.99\nBF000146 | 1.48 | 89.2\nBF000147 | 0.0 | 0.0\nBF000148 | 0.0 | 0.0\nBF000150 | 0.0 | 0.0\n"
  },
  {
    "question": "특수합금 합금철의 최근 3개월 월별 중량, 금액을 보여주세요.",
    "answer": "특수합금 합금철의 최근 3개월 동안의 월별 중량과 금액은 다음과 같습니다. 총 중량은 {df['total_weight'].sum()}kg이며, 총 금액은 {df['total_amount'].sum()}원입니다.",
    "stats": "year_month | total_weight_ton | total_amount_billion\n----------------------------------------------------\n2025-02 | 173.05 | 64.57\n"
  },
  {
    "question": "24년 8월 전체 합금철 자재를 중분류와 소분류로 구분하여 중량, 금액을 표시해주세요.",
    "answer": "2024년 8월에는 각각의 중분류와 소분류에 따른 합금철 자재의 총 중량은 {df['total_weight'].sum()}kg이고, 총 금액은 {df['total_amount'].sum()}원입니다.",
    "stats": "sap_category_l2 | sap_category_l3 | total_weight | total_amount\n---------------------------------------------------------------\nAL | AL METAL | 115954.0 | 372917289.0\nAL | AL탈산제 | 99026.0 | 158954939.0\nB | FE-B | 10000.0 | 46053596.0\nCR | (H)FE-CR | 2030797.0 | 4525639949.0\nCR | (L)FE-CR | 123000.0 | 566726760.0\n... (중간 생략) ...\n특수합금철 | NI-NB | 0.0 | 0.0\n특수합금철 | NI-TA | 3654.0 | 1217015468.0\n특수합금철 | NI-ZR | 495.0 | 29915436.0\n특수합금철 | TI SPONGE | 19718.0 | 281472820.0\n특수합금철 | 전기동 | 26793.0 | 331051942.0\n"
  },
  {
    "question": "자재 중에서 Cathode Ni의 24년 월별 추이를 보여주세요.",
    "answer": "Cathode Ni 자재의 2024년 월별 총 중량은 {df['total_weight'].sum()}kg이며, 총 금액은 {df['total_amount'].sum()}원입니다. 월별 자세한 중량과 금액은 다음과 같습니다.",
    "stats": "sap_category_l2 | sap_category_l3 | total_weight | total_amount\n---------------------------------------------------------------\nAL | AL METAL | 115954.0 | 372917289.0\nAL | AL탈산제 | 99026.0 | 158954939.0\nB | FE-B | 10000.0 | 46053596.0\nCR | (H)FE-CR | 2030797.0 | 4525639949.0\nCR | (L)FE-CR | 123000.0 | 566726760.0\n... (중간 생략) ...\n특수합금철 | NI-NB | 0.0 | 0.0\n특수합금철 | NI-TA | 3654.0 | 1217015468.0\n특수합금철 | NI-ZR | 495.0 | 29915436.0\n특수합금철 | TI SPONGE | 19718.0 | 281472820.0\n특수합금철 | 전기동 | 26793.0 | 331051942.0\n"
  },
  {
    "question": "자재 중에서 Fe-Ni의 24년 월별 추이를 보여주세요.",
    "answer": "2024년도에 Fe-Ni 자재의 월별 총 중량은 {df['total_weight']}kg이며, 총 금액은 {df['total_amount']}원 입니다. 월별 자재 중량과 금액의 추이는 표와 같습니다.",
    "stats": "year_month | total_weight | total_amount\n----------------------------------------\n2024-01 | 1182580.0 | 5826801043.0\n2024-02 | 1062580.0 | 5220091441.0\n2024-03 | 904580.0 | 4421257131.0\n2024-04 | 816580.0 | 3976336755.0\n2024-05 | 439580.0 | 2070257422.0\n2024-06 | 299580.0 | 1362429553.0\n"
  },
  {
    "question": "24년 2분기의 자가철 스크랩 중량과 금액을 표시하고 특수합금만 따로 표시해주세요.",
    "answer": "2024년 2분기의 자가철 스크랩의 총 중량은 {df['total_weight']}kg이며, 총 금액은 {df['total_amount']}원입니다. 이 중 특수합금의 중량은 {df['합계_중량_특수합금']}kg이고, 금액은 {df['합계_금액_특수합금']}원입니다.",
    "stats": "total_weight | total_amount | special_alloy_weight | special_alloy_amount\n-------------------------------------------------------------------------\n145036319.0 | 473610948632.0 | 18673730.0 | 283064323143.0\n"
  },
  {
    "question": "24년 7, 8, 9월 자재를 평가클래스별로 나눠 중량, 금액을 보여주세요. 전체의 평균 값도 같이 표시해주세요.",
    "answer": "2024년 7, 8, 9월에 평가 클래스별로 나눈 자재의 총 중량은 {df['total_weight'].sum()}kg이고, 총 금액은 {df['total_amount'].sum()}원입니다. 평균 중량은 {df['avg_weight'].mean()}kg이며, 평균 금액은 {df['avg_amount'].mean()}원입니다.",
    "stats": "total_weight | total_amount | special_alloy_weight | special_alloy_amount\n-------------------------------------------------------------------------\n145036319.0 | 473610948632.0 | 18673730.0 | 283064323143.0\n"
  },
  {
    "question": "24년 7, 8, 9월 자재를 평가클래스별로 나눠 중량, 금액을 보여주세요. 각 월의 평균 값도 같이 표시해주세요.",
    "answer": "2024년 7, 8, 9월에 평가클래스별로 나눈 자재의 총 중량은 {df['total_weight'].sum()}kg이며, 총 금액은 {df['total_amount'].sum()}원입니다. 또한, 각 월별 평균 중량은 {df['avg_weight'].mean()}kg, 평균 금액은 {df['avg_amount'].mean()}원입니다.",
    "stats": "total_weight | total_amount | special_alloy_weight | special_alloy_amount\n-------------------------------------------------------------------------\n145036319.0 | 473610948632.0 | 18673730.0 | 283064323143.0\n"
  },
  {
    "question": "최근 3개월의 자재 중 사내 자가발생철 자재의 중량 추이를 조회하고, 각 월별로 중량이 가장 큰 항목을 표시해주세요.",
    "answer": "최근 3개월 동안 사내 자가발생철 자재의 총 중량은 {df['total_weight'].sum()}kg이며, 각 월별로 중량이 가장 큰 자재는 {df.sort_values('total_weight', ascending=False).iloc[0]['max_material_detail']}입니다.",
    "stats": "total_weight | total_amount | special_alloy_weight | special_alloy_amount\n-------------------------------------------------------------------------\n145036319.0 | 473610948632.0 | 18673730.0 | 283064323143.0\n"
  },
  {
    "question": "24년 7,8,9월의 자재 중 사내 자가발생철 자재의 중량을 자재내역 별로 조회하세요. 월을 컬럼으로 전환한 후 자재내역 별로 8월과 9월 기준으로 전월 대비 증감을 계산해 표시해주세요.",
    "answer": "24년 7,8,9월의 자재 중 사내 자가발생철 자재의 중량을 자재내역 별로 조회하였습니다. 8월과 9월에는 각각 전월 대비 {df['weight_diff_2408'].sum()}kg, {df['weight_diff_2409'].sum()}kg 증가하였습니다. 자재내역 별로 상세한 중량과 월별 증감을 확인하실 수 있습니다.",
    "stats": "total_weight | total_amount | special_alloy_weight | special_alloy_amount\n-------------------------------------------------------------------------\n145036319.0 | 473610948632.0 | 18673730.0 | 283064323143.0\n"
  },
  {
    "question": "24년 7, 8, 9월 원부원료의 중량 추이를 조회하고, 각 월별로 중량이 가장 큰 자재 아이템을 표시해주세요.",
    "answer": "2024년 7월부터 9월까지 원부자재의 총 중량은 {df['total_weight'].sum()}kg이며, 각 월별로 중량이 가장 큰 자재 아이템은 다음과 같습니다.",
    "stats": "total_weight | total_amount | special_alloy_weight | special_alloy_amount\n-------------------------------------------------------------------------\n145036319.0 | 473610948632.0 | 18673730.0 | 283064323143.0\n"
  },
  {
    "question": "24년 7, 8, 9월의 원부원료 중량을 자재 아이템 별로 조회하세요. 월을 컬럼으로 전환한 후 아이템 별로 8월, 9월 기준 전월 대비 증감을 계산해 표시해주세요.",
    "answer": "2024년 7월, 8월, 9월 각 월별로 원부자재 아이템 별 총 중량을 조회한 결과를 통계 테이블로 제공하였습니다. 또한, 각 아이템 별로 8월과 9월의 월별 중량 증감을 계산하여 표시하였습니다. 자세한 내용은 조회된 통계 테이블을 참조해 주세요.",
    "stats": "total_weight | total_amount | special_alloy_weight | special_alloy_amount\n-------------------------------------------------------------------------\n145036319.0 | 473610948632.0 | 18673730.0 | 283064323143.0\n"
  },
  {
    "question": "24년 7, 8, 9월의 원부원료 중량을 자재 아이템 별로 조회하세요. 월을 컬럼으로 전환해 아이템 별로 8월, 9월 기준으로 전월 대비 증감을 계산하세요. 8월과 9월 각각에 대해 상승폭이 가장 큰 자재 아이템을 표시해주세요.",
    "answer": "2024년 8월에 전월 대비 중량 증가가 가장 큰 자재 아이템은 {df[df['year_month'] == '2024-08'].sort_values('weight_diff_mom', ascending=False).iloc[0]['material_detail']}이며, 증가량은 {df[df['year_month'] == '2024-08'].sort_values('weight_diff_mom', ascending=False).iloc[0]['weight_diff_mom']}kg입니다. 2024년 9월에 전월 대비 중량 증가가 가장 큰 자재 아이템은 {df[df['year_month'] == '2024-09'].sort_values('weight_diff_mom', ascending=False).iloc[0]['material_detail']}이며, 증가량은 {df[df['year_month'] == '2024-09'].sort_values('weight_diff_mom', ascending=False).iloc[0]['weight_diff_mom']}kg입니다.",
    "stats": "total_weight | total_amount | special_alloy_weight | special_alloy_amount\n-------------------------------------------------------------------------\n145036319.0 | 473610948632.0 | 18673730.0 | 283064323143.0\n"
  },
  {
    "question": "24년 7월의 자재를 대상으로 SAP 대분류 별로 중량을 계산하고 그 중량을 다시 중분류로 나눠 표시해주세요.",
    "answer": "2024년 7월의 자재를 대상으로, 각 SAP 대분류별 총 중량은 {df.groupby('SAP대분류명')['total_weight'].sum()}kg이며, 이를 다시 중분류별로 나누면 {df.groupby(['SAP대분류명', 'sap_category_l2'])['total_weight'].sum()}kg 입니다.",
    "stats": "sap_category_l1 | sap_category_l2 | total_weight\n------------------------------------------------\n |  | 0.0\n공기구 | 가열공구 | 96.0\n공기구 | 건설/파쇄공구 | 38.0\n공기구 | 고정공구 | 15.0\n공기구 | 공구부속/보조용품 | 6624.0\n... (중간 생략) ...\n합금철 | 특수합금철 | 2658809.0\n화공품 | 도료재 | 63.0\n화공품 | 시험약품 | 1162619.0\n화공품 | 실험기자재 | 226.0\n화공품 | 화공약품 | 352165.0\n"
  },
  {
    "question": "24년 전체 자재의 월별 추이를 표시해주세요.",
    "answer": "2024년 동안 월별 자재의 총 중량은 {df['total_weight'].sum()}kg이고, 총 금액은 {df['total_amount'].sum()}원입니다. 월별 자재 사용 추이는 표를 참조하세요.",
    "stats": "year_month | total_weight | total_amount\n----------------------------------------\n2024-01 | 66821743.62500007 | 198730921684.0\n2024-02 | 65638318.84100007 | 201341415877.0\n2024-03 | 61217054.21000006 | 188352026731.0\n2024-04 | 65363886.426000014 | 186278984252.0\n2024-05 | 60234815.856000006 | 178372542365.0\n... (중간 생략) ...\n2024-08 | 56863165.0 | 127366445725.0\n2024-09 | 41749326.0 | 102705836026.0\n2024-10 | 47798430.0 | 112053136462.0\n2024-11 | 47039674.0 | 113541707359.0\n2024-12 | 42391182.0 | 103819998264.0\n"
  },
  {
    "question": "24년 3분기의 합금철을 자재 코드별로 구분하여 보여주세요. 중량과 금액 모두 표시가 필요하며 단위는 각각 톤과 백만원입니다.",
    "answer": "2024년 3분기에 사용된 합금철의 자재 코드별 총 중량은 {df['total_weight_ton'].sum()}톤이며, 총 금액은 {df['total_amount_million'].sum()} 백만원입니다. 자재 코드별로 구분한 중량과 금액은 테이블로 확인하실 수 있습니다.",
    "stats": "material_code | total_weight_ton | total_amount_million\n-------------------------------------------------------\nBF000076 | 1342.69 | 1835.92\nBF000077 | 2927.7 | 7100.6\nBF000078 | 2394.41 | 4200.2\nBF000079 | 2916.45 | 5286.96\nBF000080 | 2047.69 | 4922.84\n... (중간 생략) ...\nBF000145 | 16.7 | 878.08\nBF000146 | 5.18 | 311.49\nBF000147 | 0.0 | 0.0\nBF000148 | 0.0 | 0.0\nBF000150 | 0.0 | 0.0\n"
  },
  {
    "question": "최근 3개월의 특수합금 합금철에 대해 자재의 중량과 금액을 표시해 주세요. 톤과 억원 단위로 표시해주세요.",
    "answer": "최근 3개월 동안 특수합금 합금철의 총 중량은 {df['total_weight_ton'].sum()}톤이며, 총 금액은 {df['total_amount_billion'].sum()}억원입니다.",
    "stats": "material_code | total_weight_ton | total_amount_million\n-------------------------------------------------------\nBF000076 | 1342.69 | 1835.92\nBF000077 | 2927.7 | 7100.6\nBF000078 | 2394.41 | 4200.2\nBF000079 | 2916.45 | 5286.96\nBF000080 | 2047.69 | 4922.84\n... (중간 생략) ...\nBF000145 | 16.7 | 878.08\nBF000146 | 5.18 | 311.49\nBF000147 | 0.0 | 0.0\nBF000148 | 0.0 | 0.0\nBF000150 | 0.0 | 0.0\n"
  },
  {
    "question": "24년 9월 전체 자재 중에서 니켈 합금철에 대해 전체 중량과 금액을 천톤, 억원 단위로 나타내고 항목별로 중량 기준 내림차순으로 보여주세요.",
    "answer": "2024년 9월에 니켈 합금철의 전체 중량은 {df['total_weight_thousand_ton'].sum()} 천톤이며, 총 금액은 {df['total_amount_billion'].sum()} 억원입니다. 자재별로 보면, 중량이 가장 많은 자재는 {df.sort_values('total_weight_ton_by_material', ascending=False).iloc[0]['material_detail']}이며, 그 중량은 {df.sort_values('total_weight_ton_by_material', ascending=False).iloc[0]['total_weight_ton_by_material']}톤입니다.",
    "stats": "material_detail | total_weight_ton | total_amount_billion\n---------------------------------------------------------\nFe-Ni(35%) 페로니켈35% | 4210.0 | 212.85\nFE-NI(35%) 페로니켈30%_NI(35%이상)_CO(1.20%이하) | 2840.4 | 146.7\nMe-Ni(99%) 메탈니켈 | 2719.0 | 654.89\nNPI (NICKEL PIG IRON)_NI(10%이상) | 1361.84 | 30.2\nME-NI(99%) 메탈니켈_NI(98%이상)_C(0.05%이하)_CO( | 1180.47 | 281.07\n... (중간 생략) ...\nU-Ni(97.5%) 유니켈 | 232.83 | 58.04\nU-NI(97.5%) 유니켈_NI(96%이상)_CO(1.60%이하)_C( | 220.33 | 49.0\nFe-Ni(20%) 페로니켈20% | 0.01 | 0.0\nFE-NI(20%) 페로니켈20%_NI(16%이상)_C(3%이하)_CO( | 0.01 | 0.0\nFE-NI(18%) 페로니켈 소립_NI(14%이상)_CO(0.80%이하) | 0.0 | 0.0\n"
  }
]